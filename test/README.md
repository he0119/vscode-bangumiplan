# BangumiPlan 语法高亮测试

## 测试目的

确保所有支持的 BangumiPlan 格式都能正确进行语法高亮，避免遗漏任何格式。

## 测试文件

- `syntax-test.bp` - 主要的语法高亮测试文件
- `../test-syntax-highlight.bp` - 综合测试文件  
- `../test-sample.bp` - 基础测试文件

## 支持的格式

### 1. 带 BGM ID 的格式

#### 1.1 有进度有说明

```bangumiplan
[123456]作品名 √√√ (说明文字)
```

- 正则表达式: `^(\\s{8})\\[(\\d+)\\](.+?)\\s*(√+)\\s*\\(([^)]+)\\)\\s*$`
- 语法名称: `meta.entry.with-progress-and-note`

#### 1.2 有进度无说明

```bangumiplan
[123456]作品名 √√√
```

- 正则表达式: `^(\\s{8})(?:\\[(\\d+)\\])?(.+?)\\s*(√+)?\\s*$`
- 语法名称: `meta.entry.with-progress`

#### 1.3 有日期有说明

```bangumiplan
[123456]作品名<2024-08-23>(说明文字)
```

- 正则表达式: `^(\\s{8})\\[(\\d+)\\](.+?)\\s*<([^>]+)>\\s*\\(([^)]+)\\)\\s*$`
- 语法名称: `meta.entry.with-date-note`

#### 1.4 有日期无说明

```bangumiplan
[123456]作品名<2024-08-23>
```

- 正则表达式: `^(\\s{8})\\[(\\d+)\\](.+?)\\s*<([^>]+)>\\s*$`
- 语法名称: `meta.entry.with-date`

### 2. 无 BGM ID 的格式

#### 2.1 有进度有说明 ⭐ **修复的格式**

```bangumiplan
功勋 √√√√√√√ (就把最经典的看完了)
```

- 正则表达式: `^(\\s{8})(.+?)\\s*(√+)\\s*\\(([^)]+)\\)\\s*$`
- 语法名称: `meta.entry.no-id-with-progress-and-note`

#### 2.2 有进度无说明

```bangumiplan
功勋 √√√√√√√
```

- 正则表达式: `^(\\s{8})(.+?)\\s*(√+)\\s*$`
- 语法名称: `meta.entry.no-id-with-progress`

#### 2.3 有日期有说明

```bangumiplan
功勋<2024-08-20>(经典剧集)
```

- 正则表达式: `^(\\s{8})(.+?)\\s*<([^>]+)>\\s*\\(([^)]+)\\)\\s*$`
- 语法名称: `meta.entry.no-id-with-date-note`

#### 2.4 有日期无说明

```bangumiplan
功勋<2024-08-20>
```

- 正则表达式: `^(\\s{8})(.+?)\\s*<([^>]+)>\\s*$`
- 语法名称: `meta.entry.no-id-with-date`

### 3. 基础格式

#### 3.1 仅作品名

```bangumiplan
功勋
[123456]作品名
```

- 正则表达式: `^(\\s{8})(?:\\[(\\d+)\\])?(.+?)\\s*$`
- 语法名称: `meta.entry`

## 测试方法

1. 在 VS Code 中打开测试文件
2. 确认 BangumiPlan 扩展已安装并激活
3. 检查各种格式的语法高亮是否正确：
   - BGM ID (`[123456]`) 应显示为黄色数字
   - 观看标记 (`√√√`) 应显示为绿色粗体
   - 作品标题应显示为默认颜色
   - 完成日期 (`<2024-08-23>`) 应显示为橙色斜体
   - 说明文字 (`(说明)`) 应显示为灰色
   - 状态标题 (`正在看:`) 应显示为蓝色粗体
   - 分类标题 (`动画:`) 应显示为青色粗体

## 修复记录

### 2024-08-23

- **问题**: "功勋 √√√√√√√ (就把最经典的看完了)" 格式没有正常高亮
- **原因**: 缺少无 BGM ID 但有进度标记和说明的语法规则
- **解决**: 添加了两个新的语法规则：
  - `meta.entry.no-id-with-progress-and-note` - 无ID有进度有说明
  - `meta.entry.no-id-with-progress` - 无ID有进度无说明

## 注意事项

1. 语法规则的顺序很重要，更具体的规则应该在前面
2. 所有条目都需要 8 个空格的缩进 (`\\s{8}`)
3. 观看标记只能使用 `√` 字符，可以有多个连续的
4. 日期格式应为 `<YYYY-MM-DD>` 或类似格式
5. 说明文字用圆括号包围 `(说明内容)`
6. BGM ID 用方括号包围 `[数字]`
